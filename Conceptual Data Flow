## üî∑ Conceptual Data Flow ‚Äì Hybrid SOC Home Lab

### Overview

This project simulates a real-world SOC pipeline where security events generated on a Linux machine are ingested into Microsoft Sentinel for detection, alerting, and investigation.

The architecture demonstrates end-to-end log collection, centralized monitoring, and SIEM-based incident detection.

---

## üîπ Component Explanation

### 1Ô∏è‚É£ User Activity (SSH / System Events)

User actions such as:

* Failed SSH login attempts
* Successful logins
* sudo command usage
* Service changes

These events are written to system log files, primarily:

```
/var/log/auth.log
```

These logs serve as the primary data source.

---

### 2Ô∏è‚É£ Raspberry Pi 5 (Ubuntu 24.04)

The Raspberry Pi acts as the monitored endpoint.

Responsibilities:

* Generates system and authentication logs
* Acts as a Linux host in a hybrid SOC environment

The Pi does not analyze logs locally; it only generates events.

---

### 3Ô∏è‚É£ Azure Arc (Hybrid Machine Registration)

Azure Arc registers the Raspberry Pi as a managed resource in Azure.

Purpose:

* Enables cloud-based management of on-premises devices
* Allows Azure policies and monitoring tools to be applied

Azure Arc provides identity and control-plane management.

---

### 4Ô∏è‚É£ Azure Monitor Agent (AMA)

The Azure Monitor Agent is installed on the Raspberry Pi.

Function:

* Reads selected log files (e.g., syslog, auth.log)
* Collects log entries
* Securely transmits data to Azure

Without AMA, logs remain local and are not centralized.

---

### 5Ô∏è‚É£ Data Collection Rule (DCR)

The Data Collection Rule defines:

* What logs to collect (e.g., syslog categories: auth, authpriv)
* Where to send collected data (Log Analytics Workspace)

The DCR controls log filtering and routing.

---

### 6Ô∏è‚É£ Log Analytics Workspace

The Log Analytics Workspace acts as centralized log storage.

Capabilities:

* Stores structured log data
* Enables log querying using Kusto Query Language (KQL)
* Supports investigation and threat hunting

This layer stores raw telemetry before SIEM processing.

---

### 7Ô∏è‚É£ Microsoft Sentinel (SIEM Layer)

Microsoft Sentinel sits on top of the Log Analytics Workspace.

Functions:

* Analyzes ingested logs
* Detects suspicious patterns
* Correlates events across time and systems
* Generates alerts and incidents

Sentinel transforms raw logs into actionable security intelligence.

---

### 8Ô∏è‚É£ Analytics Rules ‚Üí Incidents ‚Üí Investigation

Analytics Rules are detection queries written in KQL.

Example:

* Detect multiple failed SSH login attempts within a time window

When rule conditions are met:

* An alert is generated
* An incident is created

SOC Investigation Process:

* Analyze source IP
* Review login history
* Determine false positive vs malicious activity
* Document findings


